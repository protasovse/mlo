{% load cropping %}

<div class="answer entry{% if push %} answer-push{% endif %}">

    <hr class="my-4">

    {# Заголовок ответа #}
    {% if item.author.role > 1 %}{# Если тип учётной записи выше, чем «клиент» #}
        <header class="answer-header{% if push %} answer-header_photo-small{% endif %}">

            <div class="question-page_l-col">
                <a class="answer-header_photo" href="{% url 'lawyer_page' item.author_id %}">
                    <img src="{% include 'account/generic/pic.html' with item=item.author %}" alt="{{ item.author }}"/>
                </a>
            </div>

            {# Имя, статус, медали #}
            <div class="question-page_r-col">

                {# Имя автора ответа #}
                <h5 class="mb-1" itemprop="name">
                    <a href="{% url 'lawyer_page' item.author_id %}">{{ item.author }}</a>
                </h5>

                {# Статус, только для юристов #}
                {% if item.author.role > 1 %}
                    <div class="normal mb-1 text-muted d-none d-sm-block">{{ item.author.info.status|default:item.author.get_role_display }}</div>
                {% endif %}

                {# Медали #}
                {% if not push %}
                    <div class="answer-header_medal mb-2">
                        <span class="item" title="Рейтинг эксперта"><i class="icon-star"></i><span
                                class="v">{{ item.author.rating.month_rate }}</span></span>
                        <span class="item" title="Стаж"><i class="icon-medal"></i><span class="v">12,6 лет</span></span>
                        <span class="item" title="Всего консультаций"><i class="icon-forum"></i><span
                                class="v">57345</span></span>
                        <!--br><span class="item" title="Общаться с юристом в чате"><i class="icon-message_bubble"></i>
                            <a class="v" href="#">Задать вопрос</a></span-->
                    </div>
                {% endif %}
            </div>

        </header>
    {% endif %}

    {# Подзаголовок: дата, номер, текст #}
    <div class="row">

        <div class="question-page_l-col">
            <time class="subtitle d-block mb-2 mt-1" itemprop="dateCreated"
                  datetime="{{ item.pub_date|date:"c" }}">{{ item.pub_date|date:"j M Y G:i" }}</time>
            <span class="d-block mt-1">№ {{ item.id }}</span>
        </div>

        <div class="question-page_r-col content">

            {% if item.author.role == 1 %}
                <h5 class="author-name mb-2" itemprop="name">
                    {{ item.author.get_full_name }}
                </h5>
            {% endif %}

            <div class="text" itemprop="text">{{ item.html_content|safe }}</div>

        </div>

    </div>

    {# Футтер: лайки/дизлайки #}
    <footer class="answer-footer row">

        <div class="question-page_l-col">&nbsp;</div>

        <div class="question-page_r-col d-flex align-items-center justify-content-between">

            <div class="answer-footer-action normal">
                {% if forloop.last %}
                    <a href="#" class="btn btn-sm btn-primary">Дополнительный вопрос<i class="icon-message_buble ml-2"></i></a>
                {% endif %}
            </div>

            <div class="answer-footer-like">
                {% include 'entry/generic/answer_footer_like.html' %}
            </div>

        </div>

    </footer>

    {# Форма ответа на вопрос #}
    <footer class="row d-none">
        <div class="question-page_r-col ml-auto">
            {% include 'entry/generic/form_reply.html' with on_question=item.on_question_id parent=item.id %}
        </div>
    </footer>

</div>


{% if item.is_parent and item.children.count %}
    {% for answer in item.children %}
        {% include 'entry/generic/answer_item.html' with item=answer push=True %}
    {% endfor %}
{% endif %}